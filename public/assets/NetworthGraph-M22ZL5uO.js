import{j as a}from"./index-BypqA20B.js";import{r as s}from"./vendor-react-BGsnWRWU.js";import{u as L}from"./useChartTheme-0-n_Utvk.js";import{f as R,C as _,a as $,L as A,P as k,b as O,p as P,c as T}from"./vendor-chart-BMU4AhuH.js";import{f as q}from"./dateFilterUtil-DgyJ2LTd.js";import"./chartTheme-DLOnjtYC.js";_.register($,A,k,O,P,T);function H({darkMode:g,wsMessages:i=[],sendWs:l,dateFrom:y,dateTo:m,onMinDate:u}){const[x,h]=s.useState({datasets:[]}),[S,c]=s.useState(!0),[C,b]=s.useState(!0),{themedOptions:N}=L(g),f=s.useRef(!1);return s.useEffect(()=>{if(!f.current&&l)try{l("getNetworth"),f.current=!0,c(!0)}catch{}},[l]),s.useEffect(()=>{if(!(!i||i.length===0))for(let e=i.length-1;e>=0;e--){const d=i[e];if(typeof d=="string"&&d.startsWith("{"))try{const r=JSON.parse(d);if(r&&r.type==="getNetworth"){if(r.error){h({datasets:[]}),c(!1);return}const p=Array.isArray(r.data)?r.data:[],n=p.map(t=>{try{if(!t?.date)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(t.date.slice(0,10)))return t.date.slice(0,10);const o=new Date(t.date);if(isNaN(o.getTime()))return String(t.date);const D=o.getFullYear(),v=String(o.getMonth()+1).padStart(2,"0"),E=String(o.getDate()).padStart(2,"0");return`${D}-${v}-${E}`}catch{return String(t?.date||"")}}),j=p.map(t=>t.value);if(n.length&&u&&/^\d{4}-\d{2}-\d{2}$/.test(n[0]))try{u(n[0])}catch{}const w=q(n,[{label:"Networth",data:j,borderColor:"rgba(75, 192, 192, 0.9)",backgroundColor:"rgba(75, 192, 192, 0.3)",pointRadius:3,showLine:!0,fill:!1,tension:.2}],y,m);h(w),c(!1);return}}catch{}}},[i]),a.jsxs("div",{className:"my-4",children:[a.jsx("h5",{style:{cursor:"pointer",userSelect:"none"},onClick:()=>b(e=>!e),title:"Click to show/hide chart",children:"Networth by Date"}),S?a.jsx("div",{children:a.jsx("img",{src:"/images/loader.gif",alt:"Chargement...",style:{maxWidth:"80px"}})}):C&&a.jsx("div",{style:{height:400},children:a.jsx(R,{data:x,options:N({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0},title:{display:!1},tooltip:{enabled:!0}},scales:{x:{title:{display:!0,text:"Date"},type:"category"},y:{title:{display:!0,text:"Networth"},beginAtZero:!0}}})})})]})}export{H as default};
